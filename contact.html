<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <meta name="color-scheme" content="dark" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="apple-mobile-web-app-title" content="INFINITEX" />

  <link rel="icon" href="assets/icons/icon-192.png" />
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png" />
  <title>INFINITEX â€” Ù…Ø³Ø§Ø¹Ø¯Ø©</title>
  <meta name="description" content="Ù…Ø³Ø§Ø¹Ø¯Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø´Ø§Øª INFINITEX Ø¨ØªØµÙ…ÙŠÙ… Ù…Ø¯Ù…Ø¬." />

  <link rel="preload" href="assets/fonts/avenir-black-arabic.otf" as="font" type="font/otf" crossorigin>

  <style>
    @font-face {
      font-family: "AvenirBlackArabic";
      src: url("assets/fonts/avenir-black-arabic.otf") format("opentype");
      font-display: swap;
    }

    :root {
      --bg: #050607;
      --text: #eef2f3;
      --muted: #a7b0b5;
      --muted2: #7d878d;
      --line: rgba(255,255,255,.08);
      --accent: #39ff14;
      --accent2: #2bdc12;
      --gold: #ffd700;
      --red: #ff4757;
      --radius: 20px;
      --max: 700px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; background: #000; width: 100%; overflow-x: hidden; }

    body {
      font-family: "AvenirBlackArabic", system-ui, sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, var(--bg) 0%, #07090a 100%);
      overflow-x: hidden;
      max-width: 100vw;
      width: 100%;
      position: relative;
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
    }

    img { max-width: 100%; height: auto; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

    .animate { animation: fadeIn 0.5s ease forwards; opacity: 0; }
    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }

    .wrap { max-width: var(--max); margin: 0 auto; padding: 0 16px; width: 100%; }
    main { width: 100%; overflow-x: hidden; }
    section { padding: 40px 0; }

    .h1 { font-size: clamp(24px, 7vw, 40px); line-height: 1.15; }
    .h2 { font-size: clamp(20px, 5.5vw, 28px); line-height: 1.2; margin-bottom: 12px; }
    .h3 { font-size: clamp(16px, 4.5vw, 20px); line-height: 1.3; }
    .p { color: var(--muted); font-size: 14px; line-height: 1.85; }

    header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(0,0,0,.9);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--line);
    }
    .nav { display: flex; align-items: center; justify-content: space-between; padding: 12px 0; }
    .brand img { height: 20px; }
    .navlinks { display: flex; gap: 6px; }
    .navlinks a { padding: 8px 12px; border-radius: 10px; color: var(--muted); font-size: 12px; text-decoration: none; }
    .navlinks a:hover, .navlinks a.active { color: var(--text); background: rgba(255,255,255,.05); }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: 999px;
      font-size: 12px;
      color: var(--muted);
    }

    .dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      animation: pulse 2s infinite;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 24px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      font-family: inherit;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      text-decoration: none;
      width: 100%;
    }

    .btn:hover { transform: translateY(-2px); border-color: rgba(57,255,20,.4); }

    .btn.primary {
      background: linear-gradient(180deg, rgba(57,255,20,.95), rgba(43,220,18,.85));
      border-color: rgba(57,255,20,.6);
      color: #061006;
    }

    .btn.ghost { background: transparent; }

    .btn-row { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }

    .card {
      background: rgba(255,255,255,.02);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 24px 20px;
      margin-bottom: 16px;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .feature-card {
      background: rgba(0,0,0,.3);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 20px 16px;
      transition: all 0.3s;
    }

    .feature-card:hover {
      border-color: rgba(57,255,20,.2);
      transform: translateY(-2px);
    }

    .feature-card .emoji {
      font-size: 24px;
      margin-bottom: 10px;
    }

    .feature-card h3 {
      font-size: 15px;
      margin-bottom: 8px;
    }

    .feature-card p {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.8;
    }

    .hero {
      text-align: center;
      padding: 30px 0 40px;
      position: relative;
    }

    .hero::before {
      content: "";
      position: absolute;
      top: -100px;
      left: 50%;
      transform: translateX(-50%);
      width: 500px;
      height: 400px;
      background: radial-gradient(circle, rgba(57,255,20,.12) 0%, transparent 60%);
      pointer-events: none;
    }

    .hero-content { position: relative; z-index: 1; }

    .hero-subtitle {
      font-size: clamp(16px, 4.5vw, 22px);
      color: var(--muted);
      margin: 8px 0 16px;
    }

    .hero-desc {
      font-size: 14px;
      color: var(--muted);
      max-width: 500px;
      margin: 0 auto 20px;
      line-height: 1.9;
    }

    .section-header {
      text-align: center;
      margin-bottom: 24px;
    }

    .form-card {
      background: rgba(0,0,0,.45);
      border: 1px solid var(--line);
      border-radius: 22px;
      padding: 22px;
    }

    .chat-log {
      height: min(66vh, 680px);
      overflow: auto;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(400px 240px at 85% 0%, rgba(57,255,20,.08), transparent 60%),
        rgba(3,4,5,.85);
      padding: 16px;
      scrollbar-width: thin;
    }

    .msg {
      max-width: 84%;
      padding: 12px 14px;
      border-radius: 18px;
      margin: 10px 0;
      font-size: 13px;
      line-height: 1.8;
      border: 1px solid rgba(255,255,255,.10);
      position: relative;
    }

    .msg.me {
      margin-left: auto;
      background: rgba(57,255,20,.16);
      border-color: rgba(57,255,20,.35);
      border-bottom-right-radius: 6px;
    }

    .msg.bot {
      margin-right: auto;
      background: rgba(255,255,255,.04);
      border-bottom-left-radius: 6px;
    }

    .chat-row {
      display: flex;
      gap: 10px;
      margin-top: 14px;
      align-items: flex-end;
    }

    .chat-row input {
      flex: 1;
    }

    .form-group label {
      display: block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .form-group input {
      width: 100%;
      padding: 12px 14px;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--line);
      border-radius: 14px;
      color: var(--text);
      font-family: inherit;
      font-size: 14px;
    }

    .form-group input:focus {
      outline: none;
      border-color: rgba(57,255,20,.4);
    }

    .hint {
      margin-top: 12px;
      font-size: 12px;
      color: var(--muted2);
      line-height: 1.9;
    }

    .faq-list { display: flex; flex-direction: column; gap: 10px; }
    .faq-item {
      background: rgba(0,0,0,.3);
      border: 1px solid var(--line);
      border-radius: 14px;
      overflow: hidden;
    }
    .faq-q {
      width: 100%;
      padding: 14px 16px;
      background: none;
      border: none;
      color: var(--text);
      font-family: inherit;
      font-size: 14px;
      font-weight: 700;
      text-align: right;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    .faq-q svg { width: 16px; height: 16px; fill: var(--muted); transition: transform 0.3s; }
    .faq-item.open .faq-q svg { transform: rotate(180deg); }
    .faq-a { max-height: 0; overflow: hidden; transition: max-height 0.3s; }
    .faq-a-inner { padding: 0 16px 14px; color: var(--muted); font-size: 13px; line-height: 1.85; }

    .closing {
      text-align: center;
      padding: 50px 0 30px;
    }

    .closing-text {
      font-size: clamp(18px, 5vw, 24px);
      margin-bottom: 16px;
    }

    footer {
      background: #000;
      padding: 24px 0 100px;
      border-top: 1px solid var(--line);
      text-align: center;
    }
    .footer-brand { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
    .footer-copy { font-size: 11px; color: var(--muted2); }
    .footer-links { display: flex; justify-content: center; gap: 10px; margin-top: 16px; flex-wrap: wrap; }
    .footer-links a {
      padding: 8px 14px;
      border: 1px solid var(--line);
      border-radius: 8px;
      font-size: 12px;
      color: var(--muted);
      text-decoration: none;
    }
    .footer-links a.store {
      color: #061006;
      background: rgba(57,255,20,.9);
      border-color: rgba(57,255,20,.75);
    }

    .mobile-nav {
      position: fixed;
      left: 10px;
      right: 10px;
      bottom: 10px;
      z-index: 200;
      display: none;
      overflow: hidden;
    }
    .mobile-nav-bar {
      background: rgba(5,6,7,.68);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 18px;
      padding: 8px;
      display: flex;
      gap: 6px;
      width: 100%;
    }
    .mobile-nav-bar a {
      flex: 1;
      text-align: center;
      padding: 10px 6px;
      border-radius: 12px;
      background: rgba(0,0,0,.3);
      border: 1px solid rgba(255,255,255,.06);
      font-size: 10px;
      color: var(--muted);
      text-decoration: none;
    }
    .mobile-nav-bar a.active {
      border-color: rgba(57,255,20,.35);
      color: var(--text);
    }
    .mobile-nav-bar a.store {
      color: #061006;
      background: rgba(57,255,20,.9);
      border-color: rgba(57,255,20,.75);
    }

    @media (max-width: 768px) {
      .navlinks { display: none; }
      .mobile-nav { display: block; }
      section { padding: 35px 0; }
    }

    @media (max-width: 480px) {
      .wrap { padding: 0 14px; }
      .card { padding: 20px 16px; }
      .feature-card { padding: 18px 14px; }
    }

    .reveal { opacity: 0; transform: translateY(15px); transition: all 0.5s ease; }
    .reveal.visible { opacity: 1; transform: translateY(0); }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <nav class="nav">
        <div class="brand"><img src="assets/brands/infinitex-logo.png" alt="INFINITEX" /></div>
        <div class="navlinks">
          <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
          <a href="track.html">Ø§Ù„ØªØªØ¨Ø¹</a>
          <a href="returns.html">Ø§Ù„Ø¥Ø³ØªØ±Ø¬Ø§Ø¹</a>
          <a href="products.html">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
          <a href="contact.html" class="active">Ù…Ø³Ø§Ø¹Ø¯Ø©</a>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="wrap">
        <div class="hero-content">
          <div class="chip"><span class="dot"></span> Ù…Ø³Ø§Ø¹Ø¯Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</div>
          <h1 class="h1" style="margin-top: 16px;">Ù…Ø³Ø§Ø¹Ø¯Ø© Ø³Ø±ÙŠØ¹Ø©</h1>
          <p class="hero-subtitle">Ø´Ø§Øª ÙÙˆØ±ÙŠ Ù…Ø±ØªØ¨ Ù„ÙƒÙ„ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ.</p>
          <p class="hero-desc">Ø§ÙØªØ­ Ø§Ù„Ø´Ø§Øª ÙˆÙ‚Ø¯Ù‘Ù… Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ â€” ÙØ±ÙŠÙ‚ INFINITEX Ø­Ø§Ø¶Ø± Ù„Ø®Ø¯Ù…ØªÙƒ Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª.</p>

          <div class="btn-row">
            <button class="btn primary" id="sendBtnTop">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</button>
            <a href="https://infinitex.sa/" target="_blank" class="btn ghost">Ø£Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</a>
          </div>
        </div>
      </div>
    </section>

    <section class="reveal">
      <div class="wrap">
        <div class="form-card">
          <div id="chatLog" class="chat-log" aria-live="polite">
            <div class="msg bot">Ø£Ù‡Ù„Ø§Ù‹! ÙƒÙŠÙ Ù†Ù‚Ø¯Ø± Ù†Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</div>
          </div>

          <div class="chat-row">
            <div class="form-group" style="flex:1;">
              <label for="chatInput">Ø±Ø³Ø§Ù„ØªÙƒ</label>
              <input id="chatInput" name="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ù‡Ù†Ø§..." />
            </div>
            <button class="btn primary" type="button" id="sendBtn">Ø¥Ø±Ø³Ø§Ù„</button>
          </div>

          <p class="hint">Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ùƒ Ø±Ù‚Ù… Ø·Ù„Ø¨ØŒ Ø§ÙƒØªØ¨Ù‡ Ù‡Ù†Ø§ ÙˆØ³Ù†Ø³Ø§Ø¹Ø¯Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø§Ù„Ø±Ø¨Ø· ÙÙŠ Ù†ØªÙ„ÙØ§ÙŠ.</p>
        </div>
      </div>
    </section>

    <section class="reveal">
      <div class="wrap">
        <div class="section-header">
          <h2 class="h2">Ù„ÙŠØ´ Ø§Ù„Ø´Ø§Øª Ø¹Ù†Ø¯Ù†Ø§ Ù…Ù…ØªØ§Ø²ØŸ</h2>
        </div>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="emoji">âš¡</div>
            <h3>Ø±Ø¯ Ø³Ø±ÙŠØ¹</h3>
            <p>Ø±Ø¯ÙˆØ¯ ÙˆØ§Ø¶Ø­Ø© ÙˆØ³Ø±ÙŠØ¹Ø© Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¹Ù„Ù‰ Ø·ÙˆÙ„.</p>
          </div>
          <div class="feature-card">
            <div class="emoji">ğŸ¯</div>
            <h3>Ø­Ù„ÙˆÙ„ Ø¯Ù‚ÙŠÙ‚Ø©</h3>
            <p>Ø¨Ù†Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙˆÙ†Ù‚ØªØ±Ø­ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ ÙÙˆØ±Ø§Ù‹.</p>
          </div>
          <div class="feature-card">
            <div class="emoji">ğŸ›¡ï¸</div>
            <h3>Ø®ØµÙˆØµÙŠØ© ÙƒØ§Ù…Ù„Ø©</h3>
            <p>Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¢Ù…Ù†Ø© ÙˆÙ…Ø³ØªØ®Ø¯Ù…Ø© ÙÙ‚Ø· Ù„Ø®Ø¯Ù…ØªÙƒ.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="reveal">
      <div class="wrap">
        <div class="section-header">
          <h2 class="h2">Ø£Ø³Ø¦Ù„Ø© Ø´Ø§Ø¦Ø¹Ø©</h2>
        </div>
        <div class="faq-list">
          <div class="faq-item">
            <button class="faq-q" type="button"><span>ÙƒÙŠÙ Ø£ÙØªØ­ Ø§Ù„Ø´Ø§ØªØŸ</span><svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg></button>
            <div class="faq-a"><div class="faq-a-inner">Ø§Ø¶ØºØ· Ø²Ø± "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©" ÙˆØ³ÙŠØ¸Ù‡Ø± Ù„Ùƒ Ø§Ù„Ø´Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©.</div></div>
          </div>
          <div class="faq-item">
            <button class="faq-q" type="button"><span>Ù‡Ù„ Ø§Ù„Ø´Ø§Øª Ù…ØªØ§Ø­ Ø·ÙˆØ§Ù„ Ø§Ù„ÙŠÙˆÙ…ØŸ</span><svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg></button>
            <div class="faq-a"><div class="faq-a-inner">Ù†Ø¹Ù…Ù„ Ø¨Ø£Ù‚ØµÙ‰ Ø³Ø±Ø¹Ø© Ù„Ù„Ø±Ø¯ØŒ ÙˆÙÙŠ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø°Ø±ÙˆØ© Ù‚Ø¯ ÙŠØªØ£Ø®Ø± Ø§Ù„Ø±Ø¯ Ø¯Ù‚Ø§Ø¦Ù‚ Ø¨Ø³ÙŠØ·Ø©.</div></div>
          </div>
          <div class="faq-item">
            <button class="faq-q" type="button"><span>Ù‡Ù„ Ø£Ù‚Ø¯Ø± Ø£ØªØ§Ø¨Ø¹ Ø·Ù„Ø¨ÙŠ Ù…Ù† Ø§Ù„Ø´Ø§ØªØŸ</span><svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg></button>
            <div class="faq-a"><div class="faq-a-inner">Ù†Ø¹Ù…ØŒ Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ ÙˆØ³ÙŠØªÙ… Ø¥Ø±Ø´Ø§Ø¯Ùƒ Ù„Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©.</div></div>
          </div>
        </div>
      </div>
    </section>

    <section class="closing">
      <div class="wrap">
        <p class="closing-text">Ù†Ø­Ù† Ù‡Ù†Ø§ Ø¹Ø´Ø§Ù† Ù†Ø®Ø¯Ù…Ùƒ Ø¨Ø³Ø±Ø¹Ø©.</p>
        <button class="btn primary" style="max-width: 280px; margin: 0 auto;" id="sendBtnBottom">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</button>
      </div>
    </section>
  </main>

  <footer>
    <div class="wrap">
      <div class="footer-brand">INFINITEX</div>
      <p class="footer-copy">Â© <span id="year"></span> INFINITEX. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
      <div class="footer-links">
        <a href="https://infinitex.sa/" target="_blank" class="store">Ø£Ø·Ù„Ø¨</a>
        <a href="products.html">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
      </div>
    </div>
  </footer>

  <div class="mobile-nav">
    <div class="mobile-nav-bar">
      <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="track.html">Ø§Ù„ØªØªØ¨Ø¹</a>
      <a href="returns.html">Ø§Ù„Ø¥Ø³ØªØ±Ø¬Ø§Ø¹</a>
      <a href="products.html">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
      <a href="contact.html" class="active">Ù…Ø³Ø§Ø¹Ø¯Ø©</a>
      <a href="https://infinitex.sa/" target="_blank" class="store">Ø£Ø·Ù„Ø¨</a>
    </div>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const POPCORN_PROXY_URL = window.IX_POPCORN_PROXY_URL || '/api/track';
    const chatLog = document.getElementById('chatLog');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');
    const sendBtnTop = document.getElementById('sendBtnTop');
    const sendBtnBottom = document.getElementById('sendBtnBottom');

    const userId = (function(){
      const k = 'ix_popcorn_uid';
      const v = localStorage.getItem(k);
      if(v) return v;
      const nv = (crypto && crypto.randomUUID) ? crypto.randomUUID() : String(Date.now());
      localStorage.setItem(k, nv);
      return nv;
    })();

    function addMsg(role, text){
      const el = document.createElement('div');
      el.className = 'msg ' + (role === 'me' ? 'me' : 'bot');
      el.textContent = text;
      chatLog.appendChild(el);
      chatLog.scrollTop = chatLog.scrollHeight;
    }

    function cleanBotText(input){
      const s = (input ?? '').toString();
      if(!s) return '';
      const marker = '}"';
      const idx = s.lastIndexOf(marker);
      if(idx !== -1){
        let tail = s.slice(idx + marker.length);
        tail = tail.replace(/^["\\s]+/, '');
        if(/[A-Za-zØ€-Û¿]/.test(tail)) return tail.trim();
      }
      return s
        .replace(/^\\s*\\[.*?\\]\\s*/s, '')
        .replace(/^\\s*\"\\s*\\{.*?\\}\\s*\"\\s*/s, '')
        .trim();
    }

    async function sendChat(){
      const text = (chatInput.value || '').trim();
      if(!text){
        addMsg('bot', 'Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹.');
        return;
      }

      addMsg('me', text);
      chatInput.value = '';

      sendBtn.disabled = true;
      const thinking = document.createElement('div');
      thinking.className = 'msg bot';
      thinking.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±Ø¯...';
      chatLog.appendChild(thinking);
      chatLog.scrollTop = chatLog.scrollHeight;

      try{
        const res = await fetch(POPCORN_PROXY_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ userId, message: text })
        });

        const data = await res.json().catch(()=> ({}));
        thinking.remove();

        if(!res.ok){
          addMsg('bot', data?.error || 'Ø­ØµÙ„ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø§Øª. Ø¬Ø±Ù‘Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©.');
          return;
        }
        addMsg('bot', cleanBotText(data?.response || data?.message || data?.output) || 'ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„ÙƒÙ† Ù„Ù… ÙŠØµÙ„ Ø±Ø¯ ÙˆØ§Ø¶Ø­.');
      }catch(e){
        thinking.remove();
        addMsg('bot', 'ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©. Ø¬Ø±Ù‘Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©.');
      }finally{
        sendBtn.disabled = false;
      }
    }

    sendBtn?.addEventListener('click', sendChat);
    sendBtnTop?.addEventListener('click', () => chatInput?.focus());
    sendBtnBottom?.addEventListener('click', () => chatInput?.focus());
    chatInput?.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') sendChat(); });

    document.querySelectorAll('.faq-q').forEach(btn => {
      btn.addEventListener('click', () => {
        const item = btn.parentElement;
        const answer = item.querySelector('.faq-a');
        const isOpen = item.classList.contains('open');

        document.querySelectorAll('.faq-item').forEach(i => {
          i.classList.remove('open');
          i.querySelector('.faq-a').style.maxHeight = '0';
        });

        if (!isOpen) {
          item.classList.add('open');
          answer.style.maxHeight = answer.scrollHeight + 'px';
        }
      });
    });

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('visible');
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
  </script>
</body>
</html>
