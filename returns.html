<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <meta name="color-scheme" content="dark" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="apple-mobile-web-app-title" content="INFINITEX" />

  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="assets/icons/icon-192.png" />
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png" />

  <title>INFINITEX — الاسترجاع</title>
  <meta name="description" content="استرجاع منظم وموثّق — الضمان الذهبي من INFINITEX." />

  <link rel="preload" href="assets/fonts/avenir-black-arabic.otf" as="font" type="font/otf" crossorigin>

  <style>
    @font-face{
      font-family:"AvenirBlackArabic";
      src:url("assets/fonts/avenir-black-arabic.otf") format("opentype");
      font-display:swap;
    }

    :root{
      --bg:#050607; --bg2:#0a0c0d;
      --card:#0f1213;
      --text:#eef2f3; --muted:#a7b0b5; --muted2:#7d878d;
      --line: rgba(255,255,255,.08);
      --accent:#39ff14;
      --shadow: 0 24px 80px rgba(0,0,0,.55);
      --radius:18px; --radius2:24px;
      --max: 1120px;

      /* Popcorn launcher (overridden on mobile) */
      --chat-launcher-bottom: 24px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    html{background:#000}
    body{
      margin:0;
      color:var(--text);
      background:
        radial-gradient(1100px 560px at 80% -10%, rgba(57,255,20,.18), transparent 60%),
        radial-gradient(900px 600px at 10% 10%, rgba(57,255,20,.10), transparent 55%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
      font-family:"AvenirBlackArabic", system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
      overflow-x:hidden;
    }

    a{color:inherit; text-decoration:none}
    .wrap{max-width:var(--max); margin:0 auto; padding: 0 18px}

    .chip{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius:999px;
      color: var(--muted);
      font-size: 13px;
    }
    .dot{width:8px; height:8px; border-radius:999px; background:var(--accent); box-shadow:0 0 18px rgba(57,255,20,.6)}

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      padding:14px 16px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.02);
      color: var(--text);
      cursor:pointer;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      user-select:none;
      font-weight: 800;
      font-family: inherit;
    }
    .btn:hover{transform: translateY(-1px); border-color: rgba(57,255,20,.45)}
    .btn:active{transform: translateY(0px)}
    .btn.primary{
      background: linear-gradient(180deg, rgba(57,255,20,.95), rgba(43,220,18,.85));
      border-color: rgba(57,255,20,.65);
      color:#061006;
      box-shadow: 0 18px 60px rgba(57,255,20,.18);
    }
    .btn.ghost{border-color: rgba(255,255,255,.10)}

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    /* Header */
    header{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(14px);
      background:#000;
      padding-top: env(safe-area-inset-top);
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .nav{display:flex; align-items:center; justify-content:space-between; gap:12px; padding: 16px 0}
    .brand{display:flex; align-items:center; gap:12px; min-width: 160px}
    .brand img{height: 22px; opacity:.98}
    .navlinks{display:flex; align-items:center; gap:10px}
    .navlinks a{padding:10px 10px; border-radius: 12px; border:1px solid transparent; color: var(--muted); font-size: 13px;}
    .navlinks a:hover{border-color: rgba(255,255,255,.10); color: var(--text)}
    .navlinks a.active{border-color: rgba(57,255,20,.35); color: var(--text)}
    .navCtas{display:flex; gap:10px; align-items:center}

    /* Hero */
    .hero{padding: 18px 0 8px}
    .heroCard{padding: 18px; border-radius: var(--radius2); position:relative; overflow:hidden}
    .heroCard::before{
      content:""; position:absolute; inset:-1px;
      background: radial-gradient(900px 420px at 65% 0%, rgba(57,255,20,.22), transparent 62%);
      opacity:.9; pointer-events:none;
    }
    .heroGrid{position:relative; display:grid; grid-template-columns: 1.08fr .92fr; gap:14px; align-items:start}

    .h1{font-size: clamp(26px, 7.4vw, 52px); line-height:1.05; margin: 12px 0 10px}
    .p{margin:0; color: var(--muted); font-size: 14px; line-height: 1.85}

    /* Form */
    .formCard{
      padding: 14px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .formHead{display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom: 10px;}
    .formHead b{font-size: 13px}
    .yammLogo{
      height: 22px;
      background: rgba(255,255,255,.92);
      padding: 6px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.18);
    }

    .field{margin-top:10px}
    .label{display:block; font-size:12px; color: var(--muted); margin-bottom:8px}
    .input{
      width:100%;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      color: var(--text);
      outline:none;
      font-family: inherit;
      font-size: 14px;
    }
    .input:focus{border-color: rgba(57,255,20,.45); box-shadow: 0 0 0 3px rgba(57,255,20,.08)}
    .input::placeholder{color: rgba(167,176,181,.55)}

    .phoneRow{display:flex; gap:10px; align-items:stretch;}
    .cc{
      min-width: 84px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 0 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      color: var(--muted);
      font-weight: 900;
      font-size: 13px;
      user-select:none;
      direction:ltr;
    }

    .submitRow{margin-top:12px}
    .submitRow .btn{width:100%}

    .hint{
      margin-top: 10px;
      padding: 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      font-size: 12px;
      line-height: 1.9;
    }
    .hint a{border-bottom: 1px dashed rgba(255,255,255,.28)}
    .hint a:hover{border-bottom-color: rgba(57,255,20,.55); color: var(--text)}

    footer{
      padding: 26px 0 calc(110px + env(safe-area-inset-bottom));
      color: var(--muted2);
      font-size: 12px;
      background:#000;
    }

    /* Mobile bottom nav (مثل رقم 2) */
    .mobileNav{position:fixed; left:12px; right:12px; bottom: calc(12px + env(safe-area-inset-bottom)); z-index:70; display:none}
    .mobileNavBar{
      display:flex; gap:8px; align-items:stretch; justify-content:space-between;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(5,6,7,.78);
      backdrop-filter: blur(12px);
      padding: 8px;
    }
    .mnItem{
      flex:1;
      padding: 10px 8px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.02);
      color: var(--muted);
      font-size: 12px;
      text-align:center;
      white-space:nowrap;
      font-weight: 800;
    }
    .mnItem.active{border-color: rgba(57,255,20,.35); color: var(--text)}
    .mnItem.store{color:#061006; background: rgba(57,255,20,.90); border-color: rgba(57,255,20,.75)}

    @media (max-width: 980px){
      .navlinks{display:none}
      .navCtas{display:none}
      .mobileNav{display:block}
      body{padding-bottom: calc(96px + env(safe-area-inset-bottom))}
      .heroGrid{grid-template-columns: 1fr; }
    }

    @media (max-width: 520px){
      body{background: linear-gradient(180deg, var(--bg) 0%, #07090a 100%) !important;}
      .wrap{padding:0 14px}
      .brand img{height:20px}
      .hero{padding: 14px 0 6px}
      .heroCard{padding: 16px}
    }

    /* Popcorn launcher above bottom nav */
    @media (max-width: 980px){
      :root{ --chat-launcher-bottom: calc(env(safe-area-inset-bottom, 0px) + 140px); }
    }
    button[id*="popcorn"],
    button[class*="popcorn"],
    a[id*="popcorn"],
    a[class*="popcorn"],
    div[id*="popcorn"][role="button"],
    div[class*="popcorn"][role="button"]{
      bottom: var(--chat-launcher-bottom) !important;
    }
  </style>
  <script src="assets/js/ix-live-content.js" defer></script>
</head>

<body>
  <header>
    <div class="wrap">
      <div class="nav">
        <div class="brand" aria-label="INFINITEX">
          <a href="index.html" aria-label="الرئيسية"><img src="assets/brands/infinitex-logo.png" alt="INFINITEX" data-ix-src="global.media.infinitexLogo" /></a>
          <span class="chip" id="ix-afterSalesChip" data-ix-chip="global.chipAfterSales"><span class="dot"></span> خدمات ما بعد البيع</span>
        </div>

        <nav class="navlinks" aria-label="التنقل">
          <a href="index.html" data-ix-text="global.nav.home">الرئيسية</a>
          <a href="track.html" data-ix-text="global.nav.track">تتبع الطلب</a>
          <a class="active" href="returns.html" data-ix-text="global.nav.returns">الاسترجاع</a>
          <a href="products.html" data-ix-text="global.nav.products">المنتجات</a>
        </nav>

        <div class="navCtas">
          <a class="btn primary" href="https://infinitex.sa/" target="_blank" rel="noopener" data-ix-href="global.links.store" data-ix-text="global.nav.store">المتجر</a>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap hero">
    <section class="heroCard card" aria-label="الاسترجاع">
      <div class="heroGrid">

        <!-- النص -->
        <div>
          <div class="chip" id="ix-returns-badge" data-ix-chip="pages.returns.badge"><span class="dot"></span> استرجاع منظم وموثّق</div>
          <h1 class="h1" id="ix-returns-title" data-ix-html="pages.returns.title">اشترِ بثقة…<br/>واسترجع بكل وضوح</h1>
          <p class="p" id="ix-returns-desc" data-ix-text="pages.returns.desc">
            صممنا “الضمان الذهبي” لتكون تجربة الشراء أكثر اطمئنانًا. من هذه الصفحة ستصل مباشرةً إلى السياسة الرسمية وتبدأ طلب الاسترجاع عبر “يم (Yamm)” بخطوات واضحة.
          </p>

          <div class="hint" style="margin-top:14px">
            للوصول إلى السياسة الرسمية: <a id="ix-returns-policyLink" href="https://infinitex.sa/blogs/gold-warranty-policy" target="_blank" rel="noopener" data-ix-href="global.links.warrantyPolicy" data-ix-text="pages.returns.policyCta">فتح سياسة الضمان الذهبي</a>
          </div>
        </div>

        <!-- النموذج -->
        <div class="formCard card" aria-label="نموذج طلب استرجاع">
          <div class="formHead">
            <b id="ix-returns-formTitle" data-ix-text="pages.returns.formTitle">نموذج طلب استرجاع</b>
            <img class="yammLogo" id="ix-yamm-logo" src="assets/brands/yamm-logo.png" alt="Yamm" data-ix-src="global.media.yammLogo" />
          </div>

          <form id="returnForm" novalidate>
            <div class="field">
              <label class="label" for="orderNumber" id="ix-returns-orderLabel" data-ix-text="pages.returns.orderLabel">رقم الطلب</label>
              <input
                class="input"
                id="orderNumber"
                name="orderNumber"
                inputmode="numeric"
                autocomplete="off"
                placeholder="مثال: 3455"
                data-ix-placeholder="pages.returns.orderPlaceholder"
                required
              />
            </div>

            <div class="field">
              <label class="label" for="phoneLocal" id="ix-returns-phoneLabel" data-ix-text="pages.returns.phoneLabel">رقم الجوال</label>
              <div class="phoneRow">
                <div class="cc" id="ix-returns-cc" aria-hidden="true" data-ix-cc="yamm.phone.countryCode">+966</div>
                <input
                  class="input"
                  id="phoneLocal"
                  name="phoneLocal"
                  inputmode="tel"
                  autocomplete="tel"
                  placeholder="5XXXXXXXX"
                  data-ix-placeholder="pages.returns.phonePlaceholder"
                  required
                />
              </div>
            </div>

            <div class="submitRow">
              <button class="btn primary" id="ix-returns-cta" type="submit" data-ix-text="pages.returns.cta">ابدأ طلب الاسترجاع</button>
            </div>

            <div id="msg" class="hint" style="display:none"></div>

            <div class="hint" style="margin-top:10px">
              بعد الإرسال سيتم تحويلك تلقائياً إلى بوابة يم الرسمية.
              <span id="fallback" style="display:none"><br/>إذا لم يتم التحويل: <a id="fallbackLink" href="#">اضغط هنا</a></span>
            </div>
          </form>
        </div>

      </div>
    </section>
  </main>

  <footer>
    <div class="wrap">
      <div style="border-top:1px solid rgba(255,255,255,.08); padding-top: 14px">
        <div>© <span id="year"></span> INFINITEX — الاسترجاع</div>
      </div>
    </div>
  </footer>

  <!-- Mobile bottom nav (نفس رقم 2) -->
  <div class="mobileNav" role="navigation" aria-label="تنقل سريع">
    <div class="mobileNavBar">
      <a class="mnItem" href="index.html" data-ix-text="global.mobileNav.services">خدمات</a>
      <a class="mnItem" href="track.html" data-ix-text="global.mobileNav.track">تتبع</a>
      <a class="mnItem active" href="returns.html" data-ix-text="global.mobileNav.returns">استرجاع</a>
      <a class="mnItem" href="products.html" data-ix-text="global.mobileNav.products">منتجات</a>
      <a class="mnItem store" href="https://infinitex.sa/" target="_blank" rel="noopener" data-ix-href="global.links.store" data-ix-text="global.mobileNav.store">متجر</a>
    </div>
  </div>

  <script>
    // =========================
    // إعدادات يم (من لوحة التحكم Live)
    // =========================
    function getYammCfg(){
      const c = (window.IX_CONTENT && typeof window.IX_CONTENT === "object") ? window.IX_CONTENT : {};
      const y = (c.yamm && typeof c.yamm === "object") ? c.yamm : {};
      const params = (y.params && typeof y.params === "object") ? y.params : {};
      const phone = (y.phone && typeof y.phone === "object") ? y.phone : {};
      return {
        baseUrl: String(y.baseUrl || "https://yamm.sa/store"),
        hostname: String(y.hostname || "infinitex.sa"),
        cc: String(phone.countryCode || "966"),
        params: {
          hostname: String(params.hostname || "hostname"),
          order: String(params.order || "order_number"),
          phone: String(params.phone || "phone_number"),
          countryCode: String(params.countryCode || "country_code")
        }
      };
    }

    // =========================
    // Helpers: Arabic -> English digits, sanitize
    // =========================
    function toEnglishDigits(s){
      return String(s || "")
        .replace(/[٠-٩]/g, d => "٠١٢٣٤٥٦٧٨٩".indexOf(d))
        .replace(/[۰-۹]/g, d => "۰۱۲۳۴۵۶۷۸۹".indexOf(d));
    }

    function digitsOnly(s){
      return toEnglishDigits(s).replace(/\D+/g, "");
    }

    function normalizeSaudiMobile(input){
      // input may be: 5XXXXXXXX, 05XXXXXXXX, 9665XXXXXXXX, +9665XXXXXXXX
      const d = digitsOnly(input);
      if (!d) return { local: "", full: "" };

      let local = "";
      if (d.startsWith("966")) {
        local = d.slice(3);
      } else {
        local = d;
      }

      // remove leading zeros
      local = local.replace(/^0+/, "");

      // ensure starts with 5 and length 9
      if (!/^5\d{8}$/.test(local)) return { local: "", full: "" };

      return { local, full: "966" + local };
    }

    function buildYammUrl(orderNumber, phoneLocal, phoneFull){
      const cfg = getYammCfg();
      const url = new URL(cfg.baseUrl);

      // Primary / configurable
      url.searchParams.set(cfg.params.hostname, cfg.hostname);

      // Additional identifiers (harmless if ignored)
      url.searchParams.set("hostname", cfg.hostname);
      url.searchParams.set("domain", cfg.hostname);
      url.searchParams.set("store", cfg.hostname);
      url.searchParams.set("merchant", cfg.hostname);

      // Order number (send multiple common keys)
      const orderKeys = Array.from(new Set([
        cfg.params.order,
        "order_number","orderNumber","order","order_id","orderId","order_no","orderNo","ordernumber"
      ].filter(Boolean)));
      orderKeys.forEach(k => url.searchParams.set(k, orderNumber));

      // Phone local (LOCAL often expected)
      const localKeys = Array.from(new Set([
        cfg.params.phone,
        "phone_number","phoneNumber","phone","mobile","mobile_number","mobileNumber","msisdn_local"
      ].filter(Boolean)));
      localKeys.forEach(k => url.searchParams.set(k, phoneLocal));

      // Country code helpers
      const ccKeys = Array.from(new Set([
        cfg.params.countryCode,
        "country_code","cc"
      ].filter(Boolean)));
      ccKeys.forEach(k => url.searchParams.set(k, cfg.cc));

      // Phone full (backup)
      const fullKeys = ["phone_full","full_phone","msisdn","msisdn_full"]; 
      fullKeys.forEach(k => url.searchParams.set(k, phoneFull));

      // Extra redundancy via hash (some SPAs read from location.hash)
      const h = new URLSearchParams();
      h.set(cfg.params.hostname, cfg.hostname);
      h.set(cfg.params.order, orderNumber);
      h.set(cfg.params.phone, phoneLocal);
      h.set("phone_full", phoneFull);
      h.set("cc", cfg.cc);
      url.hash = h.toString();

      return url.toString();
    }

    // =========================
    // UI
    // =========================
    document.getElementById("year").textContent = new Date().getFullYear();

    const form = document.getElementById("returnForm");
    const msg = document.getElementById("msg");
    const fallback = document.getElementById("fallback");
    const fallbackLink = document.getElementById("fallbackLink");

    function showError(text){
      msg.style.display = "block";
      msg.textContent = text;
    }

    form.addEventListener("submit", function(e){
      e.preventDefault();

      msg.style.display = "none";
      fallback.style.display = "none";

      const order = digitsOnly(document.getElementById("orderNumber").value).trim();
      const phone = normalizeSaudiMobile(document.getElementById("phoneLocal").value);

      // Minimal validation (no assumptions beyond common formats)
      if (!/^\d{4,12}$/.test(order)) {
        showError("رقم الطلب غير صحيح. اكتب أرقام فقط (مثال: 3455).");
        document.getElementById("orderNumber").focus();
        return;
      }

      if (!phone.local) {
        showError("رقم الجوال غير صحيح. اكتب رقم سعودي يبدأ بـ 5 (مثال: 5XXXXXXXX).");
        document.getElementById("phoneLocal").focus();
        return;
      }

      const cfg = getYammCfg();

      const phoneFull = (cfg.cc || "966") + phone.local;
      const target = buildYammUrl(order, phone.local, phoneFull);

      // Provide a clickable fallback in case the browser blocks navigation
      fallbackLink.href = target;
      fallbackLink.target = "_blank";
      fallbackLink.rel = "noopener";
      fallback.style.display = "inline";

      window.location.href = target;
    });
  </script>

  <!-- INFINITEX Support Chat (Popcorn) -->
  <script
    src="https://app.trypopcorn.ai/loader.js"
    data-url="https://app.trypopcorn.ai"
    data-api-url="https://api.trypopcorn.ai"
    data-agent=""
    data-id="6e84f91f-4557-46ec-93f7-396599c5f38e">
  </script>
</body>
</html>
